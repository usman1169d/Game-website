<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Memory Game - Web Games Hub</title>
    <link rel="stylesheet" href="../styles/main.css">
    <style>
        .memory-board {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            grid-gap: 10px;
            max-width: 400px;
            margin: 0 auto;
            padding: 20px;
        }
        
        .memory-card {
            width: 80px;
            height: 80px;
            background: linear-gradient(45deg, #667eea, #764ba2);
            border: none;
            border-radius: 10px;
            cursor: pointer;
            font-size: 2rem;
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s ease;
            transform-style: preserve-3d;
        }
        
        .memory-card:hover {
            transform: scale(1.05);
        }
        
        .memory-card.flipped {
            background: white;
            color: #333;
            border: 2px solid #667eea;
        }
        
        .memory-card.matched {
            background: #4ECDC4;
            color: white;
            cursor: default;
            animation: matchPulse 0.6s ease-in-out;
        }
        
        .memory-card.disabled {
            cursor: not-allowed;
            opacity: 0.7;
        }
        
        @keyframes matchPulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.2); }
        }
        
        .game-stats {
            display: flex;
            justify-content: space-around;
            margin: 1rem 0;
            text-align: center;
        }
        
        .stat-item {
            font-weight: bold;
            color: #333;
        }
        
        .stat-value {
            font-size: 1.5rem;
            color: #667eea;
        }
    </style>
</head>
<body class="game-page" style="display: block;">
    <div class="game-header">
        <a href="../index.html" class="back-btn">‚Üê Back to Games</a>
        <h1>üß† Memory Game</h1>
    </div>

    <div class="game-container">
        <div class="game-stats">
            <div class="stat-item">
                <div>Moves</div>
                <div class="stat-value" id="moves">0</div>
            </div>
            <div class="stat-item">
                <div>Matches</div>
                <div class="stat-value" id="matches">0</div>
            </div>
            <div class="stat-item">
                <div>Time</div>
                <div class="stat-value" id="timer">0:00</div>
            </div>
        </div>
        
        <div class="memory-board" id="gameBoard">
            <!-- Cards will be generated by JavaScript -->
        </div>
        
        <div class="game-controls">
            <button onclick="startNewGame()">New Game</button>
            <button onclick="showHint()">Hint</button>
        </div>
        
        <div style="text-align: center; margin-top: 1rem;">
            <p><strong>Goal:</strong> Match all pairs of cards!</p>
        </div>
    </div>

    <script src="../js/main.js"></script>
    <script>
        class MemoryGame {
            constructor() {
                this.cards = ['üéÆ', 'üéØ', 'üé≤', 'üé™', 'üé®', 'üé≠', 'üéµ', 'üé∏'];
                this.gameCards = [...this.cards, ...this.cards];
                this.flippedCards = [];
                this.matchedPairs = 0;
                this.moves = 0;
                this.startTime = null;
                this.timerInterval = null;
                this.gameStarted = false;
                
                this.boardElement = document.getElementById('gameBoard');
                this.movesElement = document.getElementById('moves');
                this.matchesElement = document.getElementById('matches');
                this.timerElement = document.getElementById('timer');
                
                this.shuffleCards();
                this.createBoard();
                this.updateStats();
            }
            
            shuffleCards() {
                for (let i = this.gameCards.length - 1; i > 0; i--) {
                    const j = Math.floor(Math.random() * (i + 1));
                    [this.gameCards[i], this.gameCards[j]] = [this.gameCards[j], this.gameCards[i]];
                }
            }
            
            createBoard() {
                this.boardElement.innerHTML = '';
                this.gameCards.forEach((card, index) => {
                    const cardElement = document.createElement('button');
                    cardElement.className = 'memory-card';
                    cardElement.dataset.index = index;
                    cardElement.dataset.value = card;
                    cardElement.textContent = '?';
                    cardElement.addEventListener('click', () => this.flipCard(index));
                    this.boardElement.appendChild(cardElement);
                });
            }
            
            flipCard(index) {
                if (!this.gameStarted) {
                    this.startTimer();
                    this.gameStarted = true;
                }
                
                const card = this.boardElement.children[index];
                
                if (card.classList.contains('flipped') || 
                    card.classList.contains('matched') || 
                    this.flippedCards.length >= 2) {
                    return;
                }
                
                card.classList.add('flipped');
                card.textContent = card.dataset.value;
                this.flippedCards.push({element: card, index: index, value: card.dataset.value});
                
                GameUtils.playSound(660, 100);
                
                if (this.flippedCards.length === 2) {
                    this.moves++;
                    this.updateStats();
                    setTimeout(() => this.checkMatch(), 1000);
                }
            }
            
            checkMatch() {
                const [card1, card2] = this.flippedCards;
                
                if (card1.value === card2.value) {
                    // Match found
                    card1.element.classList.add('matched');
                    card2.element.classList.add('matched');
                    card1.element.classList.remove('flipped');
                    card2.element.classList.remove('flipped');
                    
                    this.matchedPairs++;
                    GameUtils.playSound(880, 200);
                    
                    if (this.matchedPairs === this.cards.length) {
                        this.gameComplete();
                    }
                } else {
                    // No match
                    card1.element.classList.remove('flipped');
                    card2.element.classList.remove('flipped');
                    card1.element.textContent = '?';
                    card2.element.textContent = '?';
                    
                    GameUtils.playSound(220, 300);
                }
                
                this.flippedCards = [];
                this.updateStats();
            }
            
            startTimer() {
                this.startTime = Date.now();
                this.timerInterval = setInterval(() => {
                    const elapsed = Math.floor((Date.now() - this.startTime) / 1000);
                    const minutes = Math.floor(elapsed / 60);
                    const seconds = elapsed % 60;
                    this.timerElement.textContent = `${minutes}:${seconds.toString().padStart(2, '0')}`;
                }, 1000);
            }
            
            stopTimer() {
                if (this.timerInterval) {
                    clearInterval(this.timerInterval);
                    this.timerInterval = null;
                }
            }
            
            gameComplete() {
                this.stopTimer();
                const elapsed = Math.floor((Date.now() - this.startTime) / 1000);
                const minutes = Math.floor(elapsed / 60);
                const seconds = elapsed % 60;
                
                GameUtils.playSound(1320, 500);
                
                setTimeout(() => {
                    alert(`Congratulations! üéâ\n\nGame completed in:\n${this.moves} moves\n${minutes}:${seconds.toString().padStart(2, '0')}`);
                }, 500);
            }
            
            updateStats() {
                this.movesElement.textContent = this.moves;
                this.matchesElement.textContent = this.matchedPairs;
            }
            
            showHint() {
                if (this.moves === 0) {
                    alert('Start playing to get hints!');
                    return;
                }
                
                // Briefly show all unmatched cards
                const unmatchedCards = Array.from(this.boardElement.children).filter(card => 
                    !card.classList.contains('matched')
                );
                
                unmatchedCards.forEach(card => {
                    if (!card.classList.contains('flipped')) {
                        card.textContent = card.dataset.value;
                        card.style.opacity = '0.7';
                    }
                });
                
                setTimeout(() => {
                    unmatchedCards.forEach(card => {
                        if (!card.classList.contains('flipped')) {
                            card.textContent = '?';
                            card.style.opacity = '1';
                        }
                    });
                }, 1500);
                
                this.moves += 2; // Penalty for using hint
                this.updateStats();
            }
            
            reset() {
                this.flippedCards = [];
                this.matchedPairs = 0;
                this.moves = 0;
                this.gameStarted = false;
                this.stopTimer();
                this.timerElement.textContent = '0:00';
                this.shuffleCards();
                this.createBoard();
                this.updateStats();
            }
        }
        
        // Initialize game
        const game = new MemoryGame();
        
        // Game control functions
        function startNewGame() {
            game.reset();
        }
        
        function showHint() {
            game.showHint();
        }
    </script>
</body>
</html>
